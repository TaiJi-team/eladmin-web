<style>
    /* .layui-tab-item .layui-show {
        overflow: visible;
    } */
    .layui-card-body {
        height: 400px;
    }
</style>
<div class="layui-card">
    <div class="layui-card-header">
        <h2 class="header-title">审核管理</h2>
        <span class="layui-breadcrumb pull-right">
          <a href="#!console">工作台</a>
          <a><cite>审核管理</cite></a>
        </span>
    </div>
    <div class="layui-card-body">
        <div class="layui-tab layui-tab-card">
            <ul class="check-title layui-tab-title">
              <li class="layui-this" check-type="auth">入驻审核</li>
              <li check-type="fin-need">融资需求审核</li>
              <li check-type="fin-product">金融产品审核</li>
            </ul>
            <div class="check-tab-content layui-tab-content">
              <div class="layui-tab-item layui-show" style="overflow: visible;">
                <!-- <div class="layui-form toolbar">
                    <input id="check-order-search-value" class="layui-input search-input" type="text" placeholder="输入关键字"/>&emsp;
                    <button id="check-order-btn-search" class="layui-btn icon-btn"><i class="layui-icon">&#xe615;</i>搜索</button>
                </div> -->
                <table class="layui-table" id="auth-check-table" lay-filter="check-order-table"></table>
            </div>
            <div class="layui-tab-item"  style="overflow: visible;">
                <!-- <div class="layui-form toolbar">
                    <input id="check-order-layui-tab-content-tab-contentearch-value" class="layui-input search-input" type="text" placeholder="输入关键字"/>&emsp;
                    <button id="check-order-btn-search" class="layui-btn icon-btn"><i class="layui-icon">&#xe615;</i>搜索</button>
                </div> -->
                <table class="layui-table" id="fin-need-check-table" lay-filter="check-order-table"></table>
                <!-- <table class="layui-table" id="auth-check-table" lay-filter="check-order-table"></table> -->
            </div>
            <div class="layui-tab-item"  style="overflow: visible;">
                <!-- <div class="layui-form toolbar">
                    <input id="check-order-search-value" class="layui-input search-input" type="text" placeholder="输入关键字"/>&emsp;
                    <button id="check-order-btn-search" class="layui-btn icon-btn"><i class="layui-icon">&#xe615;</i>搜索</button>
                </div> -->
                <table class="layui-table" id="fin-product-check-table" lay-filter="check-order-table"></table>
                <!-- <table class="layui-table" id="auth-check-table" lay-filter="check-order-table"></table> -->
              </div>
            </div>
          </div>

        <!-- <div class="layui-form toolbar">
            <input id="check-order-search-value" class="layui-input search-input" type="text" placeholder="输入关键字"/>&emsp;
            <button id="check-order-btn-search" class="layui-btn icon-btn"><i class="layui-icon">&#xe615;</i>搜索</button>
        </div>

        <table class="layui-table" id="check-order-table" lay-filter="check-order-table"></table> -->
    </div>
</div>

<script type="text/html" id="check-table-bar">
    <a class="layui-btn layui-btn-xs" lay-event="detail">详情</a>
</script>

<script>
    layui.use(['form', 'table', 'util', 'config', 'admin', 'upload'], function () {
        var form = layui.form;
        var table = layui.table;
        var config = layui.config;
        var layer = layui.layer;
        var util = layui.util;
        var admin = layui.admin;
        //上传
        var upload = layui.upload;
        
        var type = function() {
            return $($('.check-title .layui-this')[0]).attr('check-type');
        }
        var tableEle = function() {
            return '#' + $($('.check-tab-content .layui-show table')[0]).attr('id');
        }
        var renderTable = function() {
            var tab = tableEle(), tp = type();
            console.log(tab)
            console.log(tp)
            table.render({
                elem: tab,
                url: '/assets/data/' + tp +'-check.json',
                method: 'GET',
                headers:{'Authorization': 'Bearer ' + config.getToken().access_token},
                page: true,
                cols: [[
                    {type: 'numbers'},
                    {field: 'id', title: '编码', width: "7.85%"},
                    {field: 'compName', title: '企业名称', width: "20%"},
                    {field: 'compType', templet: function (d) {
                            switch(d.compType) {
                                case '1-0':
                                    return '个体户'
                                case '1-1':
                                    return '企业'
                                case '2-0':
                                    return '金融机构'
                                case '2-1':
                                    return '信用机构'
                                case '2-2':
                                    return '投资机构'
                                case '2-3':
                                    return '保险公司'
                                case '2-4':
                                    return '担保机构'
                                case '3':
                                    return '运营机构'
                            }
                        },title: '企业类型', width: "12%"},
                    {field: 'credGrade', templet: function (d) {
                            switch(d.credGrade) {
                                case 0:
                                    return '极好'
                                case 1:
                                    return '良好'
                                case 2:
                                    return '较好'
                                case 3:
                                    return '一般'
                                case 4:
                                    return '小白'
                            }
                        },title: '企业信用评级', width: "10%"
                    },
                    {field: 'applyType', templet: function (d) {
                            switch(d.applyType) {
                                case 0:
                                    return '入驻申请'
                                case 1:
                                    return '融资需求申请'
                                case 2:
                                    return '金融产品申请'
                            }
                        },title: '申请类型', width: "12%"
                    },
                    {field: 'status', templet: function (d) {
                            switch(d.status) {
                                case 0:
                                    return '未审核'
                                case 1:
                                    return '审核通过'
                                case 2:
                                    return '不通过'
                            }
                        }, title: '审核状态', width: "8%"
                    },
                    {field: 'applyTime', sort: true, templet: function (d) {
                            return util.toDateString(d.createTime);
                        }, title: '申请时间', width: "15%"
                    },
                    {fixed: 'right', align: 'center', toolbar: '#check-table-bar', title: '操作', width: '12%'}
                ]]
            });
        }
        
        // 渲染表格
        renderTable();

        $('.check-title li').on({
            click: function() {
                setTimeout(function() {
                    renderTable();
                }, 20)
            }
        })
        // 搜索按钮点击事件
        $('#check-order-btn-search').click(function () {
            var key = $('#check-order-search-key').val();
            var value = $('#check-order-search-value').val();
            table.reload('check-order-table', {where: {searchKey: key, searchValue: value}});
        });
    });

</script>