<style>
  .audit-detail{
    border-bottom: solid #E4E4E4 2px; 
    padding-bottom: 12px;
    margin-top: 10px;
  }
  .audit-detail-button{
    margin-right: 20px;
    margin-top: -5px;
    float: right;
  }
  .wait-button-span{
    /* border-right: solid 2px #E4E4E4;  */
    color:rgba(255, 0, 0, 0.562)
  }
  .entry-img{
    display: block;
    margin-bottom: 7px;
  }
  .entry-img-explain{
    margin-left: 19px;
  }
  .wait-button{
    width: 150px;
    background: none;
    border: none;
    border-bottom: solid 1px #E4E4E4;
    margin-left: 20px;
  }
  .audit-text{
    float: right;
    margin-top: 20px;
    margin-right: 70px;
  }
  .audit-span{
    margin-bottom: 12px;
    display: block;
    font:larger #E4E4E4;
  }
  img{
    width: 50px;
    margin-top: 20px;
    margin-left: 20px;
  }
  .top-window{
    border:solid #E4E4E4 1px;
    height: 150px;
  }
  .bottom-window{
    border:solid #E4E4E4 1px;
    border-bottom: none;
  }
  .later-window{
    margin-top: 20px;
  }
  .tab-title{
    background-color:#F3F3F3;
    border-bottom: solid #E4E4E4 1px;
    height: 40px;
  }
  .tab-title-span{
    margin-top:10px;
    margin-left: 20px;
    display: inline-block
  }
  .top-small-window{
    float:left;
    border:#E4E4E4 solid 1px;
    margin-top: 25px;
    margin-left: 50px;
    width: 230px;
    height: 100px;
  }
  .layadmin-caller {
    background: #fff;
    padding: 30px
  }

  .layadmin-caller em {
    font-style: normal
  }

  .layadmin-caller .caller-fl {
    float: left
  }

  .layadmin-caller .caller-fr {
    float: right
  }

  .layadmin-caller .caller-seach {
    position: relative;
    padding-bottom: 40px
  }

  .layadmin-caller .caller-seach .caller-icon {
    font-size: 18px;
    position: absolute;
    top: 9px
  }

  .layadmin-caller .caller-seach-icon {
    left: 6px
  }

  .layadmin-caller .caller-dump-icon {
    right: 6px;
    cursor: pointer
  }

  .layadmin-caller .caller-pl32 {
    padding: 0 32px
  }

  .layadmin-caller .caller-tab {
    margin: 0
  }

  .layadmin-caller .caller-contar {
    padding-bottom: 20px
  }

  .layadmin-caller .caller-contar .caller-item {
    padding: 25px 0;
    overflow: hidden;
    border-bottom: 1px solid #e0e0e0
  }

  .layadmin-caller .caller-contar .caller-item .caller-main {
    margin-left: 20px
  }

  .layadmin-caller .caller-contar .caller-item .caller-main p {
    line-height: 100%;
    padding: 8px 0
  }

  .layadmin-caller .caller-contar .caller-item .caller-main p:first-child {
    padding-top: 0
  }

  .layadmin-caller .caller-contar .caller-item .caller-main em {
    margin-left: 5px
  }

  .layadmin-caller .caller-contar .caller-item .caller-main .caller-adds i {
    padding-right: 5px;
    margin: 0
  }

  .layadmin-caller .caller-contar .caller-item .caller-main .caller-adds {
    padding-bottom: 12px
  }

  .layadmin-caller .caller-contar .caller-iconset i {
    margin: 0 5px
  }

  .layadmin-caller .caller-contar .caller-iconset i:first-child {
    margin-left: 0
  }

  .layadmin-caller .caller-contar button {
    margin-top: 22px
  }

  .layadmin-caller .caller-contar .caller-img {
    width: 40px;
    height: 40px;
    border-radius: 100%
  }

  .right-title {
    visibility: visible;
    float: right;
    margin-right: 1%;
    width: 13%;
  }

  .right-title a:hover {
    color: #5FB878 !important;
  }

  .layui-fluid {
    padding: 15px;
  }

  .layadmin-header {
    display: none;
    height: 50px;
    line-height: 50px;
    margin-bottom: 0;
    border-radius: 0;
  }

  .layadmin-header .layui-breadcrumb {
    padding: 0 15px;
  }

  .layui-card-header {
    position: relative;
  }

  .layui-card-header .layui-icon {
    line-height: initial;
    position: absolute;
    right: 15px;
    top: 50%;
    margin-top: -7px;
  }

  .layadmin-iframe {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
  }
</style>

<div class="layui-card">
  <!-- <div class="layui-card-header" id="auth-finorg">
    <h2 class="header-title"></h2>
    <span class="layui-breadcrumb pull-right">
      <a href="#!console">工作台</a>
      <a><cite></cite></a>
    </span>
  </div> -->
  <div class="layui-fluid">
    <div class="layadmin-caller">
      <div class="top-window">
        <div class="top-small-window">
          <img src="../../assets/images/受理.png"  alt="受理事项" />
          <div class="audit-text"><span class="audit-span"><b>受理事项</b></span><span>10</span></div>
        </div>
        <div class="top-small-window">
          <img src="../../assets/images/supply_audit_img.png"  alt="补录事项" />
          <div class="audit-text"><span class="audit-span"><b>补录事项</b></span><span>10</span></div>
        </div>
        <div class="top-small-window">
          <img src="../../assets/images/驳回.png"  alt="驳回事项" />
          <div class="audit-text"><span class="audit-span"><b>驳回事项</b></span><span>10</span></div>
        </div>
        <div class="top-small-window">
          <img src="../../assets/images/催办.png"  alt="催办事项" />
          <div class="audit-text"><span class="audit-span"><b>催办事项</b></span><span>10</span></div>
        </div>
      </div>
      <div class="top-window later-window">
        <div class="tab-title"><span class="tab-title-span">待处理事务</span></div>
        <div class="later-window">
          <button class="wait-button">受理事项</button><span class="wait-button-span">（31+）</span>
          <button class="wait-button">补录审核</button><span class="wait-button-span">（20+）</span>
          <button class="wait-button">催办事项</button><span class="wait-button-span">（10+）</span>
        </div>
      </div>
      <div class="top-window later-window">
        <div class="tab-title"><span class="tab-title-span">功能快捷入口</span></div>
        <div style="margin-top: 5px;">
          <div style="float: left;margin-left: 55px;">         
            <a href="index-sys.html#!stay-accept-list"><img src="../../assets/images/用户申报.png" alt="用户申报" class="entry-img"/><span class="entry-img-explain">业务受理</span></a>
          </div>
          <div style="float: left;margin-left: 55px;">         
            <img src="../../assets/images/用户管理.png" alt="用户管理" class="entry-img"/><span class="entry-img-explain">用户管理</span>
          </div>
          <div style="float: left;margin-left: 55px;">         
            <img src="../../assets/images/挂起.png" alt="业务挂起" class="entry-img"/><span class="entry-img-explain">业务挂起</span>
          </div>
          <div style="float: left;margin-left: 55px;">         
            <img src="../../assets/images/催办.png" alt="业务催办" class="entry-img"/><span class="entry-img-explain">业务催办</span>
          </div>
        </div>
      </div>
      <div class="bottom-window later-window" style="height: auto;">
        <div class="tab-title"><span class="tab-title-span">业务受理</span></div>
        <div class="later-window">
          <div class="audit-detail">
            <i class="layui-icon">&#xe60a;</i> 
            <span>贵州省小额贷款许可审批</span>
            <button type="button" class="layui-btn layui-btn-sm audit-detail-button">详情</button>
          </div>
          <div class="audit-detail">
            <i class="layui-icon">&#xe60a;</i> 
            <span>贵州省融资担保公司融资担保许可审批</span>
            <button type="button" class="layui-btn layui-btn-sm audit-detail-button">详情</button>
          </div>
          <div class="audit-detail">
            <i class="layui-icon">&#xe60a;</i> 
            <span>贵州省典当行业务许可审批</span>
            <button type="button" class="layui-btn layui-btn-sm audit-detail-button">详情</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




<script>

  layui.use(['form', 'table', 'util', 'config', 'admin', 'upload', 'laytpl', 'laypage'], function () {
    var form = layui.form;
    var table = layui.table;
    var config = layui.config;
    var layer = layui.layer;
    var util = layui.util;
    var admin = layui.admin;
    var laypage = layui.laypage;
    //上传
    var upload = layui.upload;
    var laytpl = layui.laytpl;
    var zs = '';
    var kvMap = new Map();
    var list = new Array();
    //分页
    var financeOrgTo = {
      page: 1
      , limit: 10
    }
    console.log(financeOrgTo);
    admin.req('api-finance/investorg/getList', JSON.stringify(financeOrgTo), function (data) {
      zs = data.count;
    }, 'POST');


    // laypage.render({
    //   elem: 'demo7'
    //   , count: zs
    //   , layout: ['count', 'prev', 'page', 'next', 'limit', 'limits']
    //   , jump: function (obj) {
    //     var financeOrgTo = {
    //       page: obj.curr
    //       , limit: obj.limit
    //     }
    //     console.log(financeOrgTo);
    //     admin.req('api-finance/investorg/getList', JSON.stringify(financeOrgTo), function (data) {
    //       zs = data.count;
    //       console.log(data.data);
    //       list = data.data;
    //       console.log(list);
    //     }, 'POST');
    //     for(i = 0; i < list.length; i++){
    //       list[i].id = list[i].id
    //       console.log(list[i].id)
    //     }
    //     var data2 = { //数据
    //       "title": "Layui常用模块"
    //       , "list": list
    //     }
    //     var getTpl = demo.innerHTML;
    //     view = document.getElementById('finorg-view');
    //     laytpl(getTpl).render(data2, function (html) {
    //       view.innerHTML = html;
    //     });
    //   }
    // });

    kvMap.set('comp-auth', '企业认证');
    kvMap.set('fin-org-auth', '金融机构认证');
    kvMap.set('oper-org-auth', '运营机构认证');
    var key = location.href.split('#!')[1];
    let data = {
      authName: kvMap.get(key)
    }
    $('#auth-finorg').find('h2').text(kvMap.get(key));
    $($('#auth-finorg').find('a')[1]).text(kvMap.get(key));

    //显示表单弹窗
    var showEditModel = function (data) {
      var title = '添加投资机构';
      admin.popupCenter({
        type: 2,
        title: title,
        area: ['1100px', '650px'],
        path: 'pages/invest/add.html',
        btn: ['提交', '取消'],
        success: function (layero, index) {
          $('.layui-layer').css({
            // 'z-index': '10000000',
            // 'width': '86%',
            // 'height': '90%',
            'top': '8%',
            'left': '18%'
          });
          $(':focus').blur();
          // 添加form标识
          layero.addClass('layui-form');
          // 将保存按钮改变成提交按钮
          layero.find('.layui-layer-btn0').attr({
            'lay-filter': 'component-form-group',
            'lay-submit': ''
          });

        },
        finish: function () {
          // table.reload('user-table', {});
        },
        yes: function (index, layero) {
          form.on('submit(component-form-group)', function (data) {
            finOrgAuth(data);
          })
        },
        cancel: function () {

        },
      });
    };

    if (!!localStorage.getItem('url-redirect')) {
      showEditModel();
      localStorage.removeItem('url-redirect')
      // return;
    }

    // 添加按钮点击事件
    $('.layui-btn-normal').click(function () {
      showEditModel();
    });


    // 金融入驻信息保存
    var finOrgAuth = function (data) {
      //表单数据formData
      var formData = {};
      console.log(data);
      if (data) {
        // formData.name = formData.col_name;//金融机构名字
        formData.investOrg = {
          name: data.field.name,
          creditCode: data.field.creditCode,
          detailAddr: data.field.detailAddr,
          busiScope: data.field.busiScope,
          busiPeriod: data.field.business_time,
          organization: data.field.organization,
          investIndus: data.field.investIndus,
          financeRound: data.field.financeRound,
          fundScale: data.field.fundScale,
          investOrgBrief: data.field.investOrgBrief,
          investTeamBrief: data.field.investTeamBrief,
          investIntentBrief: data.field.investIntentBrief
        }
        formData.userOrgOper = {
          userName: data.field.lepPhone,
          nickName: data.field.operName,
          mobile: data.field.operPhone,
          idNum: data.field.operCode
        };
        formData.userOrgLegper = {
          userName: data.field.lepPhone,
          nickName: data.field.lepName,
          mobile: data.field.lepPhone,
          idNum: data.field.lepCode
        };
        console.log(formData);
      }

      admin.req('api-finance/investorg/save', JSON.stringify(formData), function (data) {
        if (data.code == 0) {
          layer.msg('提交成功，待平台审核', { icon: 5, time: 2000 }, function () {
            layer.closeAll();
          });
        } else {
          layer.msg(data.msg, { icon: 5, time: 2000 }, function () {
            layer.closeAll();
          });
        }
      }, 'POST');
    }
  });
</script>

